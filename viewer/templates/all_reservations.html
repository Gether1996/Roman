{% extends 'base.html' %}
{% load static %}

{% block extra_head %}
    <title>Všetky rezervácie</title>
{% endblock %}

{% block content %}

{% include 'navbar.html' %}

<div class="container-fluid py-3" style="margin-top: 120px;">

  <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-2">
    <h2 class="h4 mb-0">Všetky rezervácie</h2>
  </div>

  <!-- paginator (Bootstrap markup is generated by updatePaginateElements) -->
  <div class="d-flex flex-wrap align-items-center justify-content-between gap-2 paginator mb-3"></div>

  <!-- quick filters -->
  <div class="d-flex flex-wrap align-items-center gap-2 mb-3">
    <div class="btn-group" role="group" aria-label="Masér">
      <button class="btn btn-sm btn-outline-primary" onclick="pickMassager('Roman')">Roman</button>
      <button class="btn btn-sm btn-outline-primary" onclick="pickMassager('Evka')">Evka</button>
      <button class="btn btn-sm btn-outline-primary" onclick="pickDate('today')">Dnes</button>
      <button class="btn btn-sm btn-outline-primary" onclick="pickDate('tomorrow')">Zajtra</button>
      <input class="form-control form-control-sm ms-2"
             type="date" id="customDatePicker" placeholder="Vybrať dátum"
             onchange="setCustomDate(event)">
    </div>
  </div>

  <div class="table-responsive">
    <table class="table table-striped table-hover table-bordered align-middle table-sm">
      <thead class="table-light">
        <tr>
          <th style="width:6%;">
            <a class="link-body-emphasis text-decoration-none"
               href="{% url 'all_reservations' %}?sort_by=worker&order={% if current_sort_by == 'worker' and current_order == 'asc' %}desc{% else %}asc{% endif %}{% if page %}&page={{ page }}{% endif %}">
              Masér {% if current_sort_by == 'worker' %}{% if current_order == 'asc' %}&#9650;{% else %}&#9660;{% endif %}{% endif %}
            </a>
          </th>
          <th>
            <a class="link-body-emphasis text-decoration-none"
               href="{% url 'all_reservations' %}?sort_by=datetime_from&order={% if current_sort_by == 'datetime_from' and current_order == 'asc' %}desc{% else %}asc{% endif %}{% if page %}&page={{ page }}{% endif %}">
              Dátum {% if current_sort_by == 'datetime_from' %}{% if current_order == 'asc' %}&#9650;{% else %}&#9660;{% endif %}{% endif %}
            </a>
          </th>
          <th class="text-center" style="width:5%;">Slot</th>
          <th class="text-center" style="width:5%;">Typ</th>
          <th>
            <a class="link-body-emphasis text-decoration-none"
               href="{% url 'all_reservations' %}?sort_by=name_surname&order={% if current_sort_by == 'name_surname' and current_order == 'asc' %}desc{% else %}asc{% endif %}{% if page %}&page={{ page }}{% endif %}">
              Meno {% if current_sort_by == 'name_surname' %}{% if current_order == 'asc' %}&#9650;{% else %}&#9660;{% endif %}{% endif %}
            </a>
          </th>
          <th>
            <a class="link-body-emphasis text-decoration-none"
               href="{% url 'all_reservations' %}?sort_by=email&order={% if current_sort_by == 'email' and current_order == 'asc' %}desc{% else %}asc{% endif %}{% if page %}&page={{ page }}{% endif %}">
              Email {% if current_sort_by == 'email' %}{% if current_order == 'asc' %}&#9650;{% else %}&#9660;{% endif %}{% endif %}
            </a>
          </th>
          <th>
            <a class="link-body-emphasis text-decoration-none"
               href="{% url 'all_reservations' %}?sort_by=phone_number&order={% if current_sort_by == 'phone_number' and current_order == 'asc' %}desc{% else %}asc{% endif %}{% if page %}&page={{ page }}{% endif %}">
              Telefón {% if current_sort_by == 'phone_number' %}{% if current_order == 'asc' %}&#9650;{% else %}&#9660;{% endif %}{% endif %}
            </a>
          </th>
          <th style="width:8%;">
            <a class="link-body-emphasis text-decoration-none"
               href="{% url 'all_reservations' %}?sort_by=created_at&order={% if current_sort_by == 'created_at' and current_order == 'asc' %}desc{% else %}asc{% endif %}{% if page %}&page={{ page }}{% endif %}">
              Vytvorená {% if current_sort_by == 'created_at' %}{% if current_order == 'asc' %}&#9650;{% else %}&#9660;{% endif %}{% endif %}
            </a>
          </th>
          <th>
            <a class="link-body-emphasis text-decoration-none"
               href="{% url 'all_reservations' %}?sort_by=special_request&order={% if current_sort_by == 'special_request' and current_order == 'asc' %}desc{% else %}asc{% endif %}{% if page %}&page={{ page }}{% endif %}">
              Poznámka {% if current_sort_by == 'special_request' %}{% if current_order == 'asc' %}&#9650;{% else %}&#9660;{% endif %}{% endif %}
            </a>
          </th>
          <th>
            <a class="link-body-emphasis text-decoration-none"
               href="{% url 'all_reservations' %}?sort_by=status&order={% if current_sort_by == 'status' and current_order == 'asc' %}desc{% else %}asc{% endif %}{% if page %}&page={{ page }}{% endif %}">
              Status {% if current_sort_by == 'status' %}{% if current_order == 'asc' %}&#9650;{% else %}&#9660;{% endif %}{% endif %}
            </a>
          </th>
          <th>Môj popis</th>
          <th class="text-center" style="width:5%;">
            <a class="link-body-emphasis text-decoration-none"
               href="{% url 'all_reservations' %}?sort_by=active&order={% if current_sort_by == 'active' and current_order == 'asc' %}desc{% else %}asc{% endif %}{% if page %}&page={{ page }}{% endif %}">
              Aktívna {% if current_sort_by == 'active' %}{% if current_order == 'asc' %}&#9650;{% else %}&#9660;{% endif %}{% endif %}
            </a>
          </th>
          <th>Zrušenie</th>
          <th style="width:4%;"></th>
        </tr>

        <!-- filter row -->
        <tr>
          <th><input class="form-control form-control-sm searching-input-table" data-filter="worker" type="text" id="sort_worker" placeholder="Masér"></th>
          <th><input class="form-control form-control-sm searching-input-table" data-filter="date" type="text" id="sort_date" placeholder="Dátum"></th>
          <th><input class="form-control form-control-sm searching-input-table text-center" data-filter="slot" type="text" id="sort_slot" placeholder="Slot"></th>
          <th><input class="form-control form-control-sm searching-input-table text-center" data-filter="type" type="text" id="sort_type" placeholder="Typ"></th>
          <th><input class="form-control form-control-sm searching-input-table" data-filter="name_surname" type="text" id="sort_name_surname" placeholder="Meno"></th>
          <th><input class="form-control form-control-sm searching-input-table" data-filter="email" type="text" id="sort_email" placeholder="Email"></th>
          <th><input class="form-control form-control-sm searching-input-table" data-filter="phone_number" type="text" id="sort_phone_number" placeholder="Telefón"></th>
          <th><input class="form-control form-control-sm searching-input-table" data-filter="created_at" type="text" id="sort_created_at" placeholder="Vytvorená"></th>
          <th><input class="form-control form-control-sm searching-input-table" data-filter="special_request" type="text" id="sort_special_request" placeholder="Poznámka"></th>
          <th><input class="form-control form-control-sm searching-input-table" data-filter="status" type="text" id="sort_status" placeholder="Status"></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>

      <tbody id="filesBody"></tbody>
    </table>
  </div>

</div>

{% endblock %}


{% block extra_scripts %}
    <script>
        var page = {{ page }};
        var current_sort_by = '{{ current_sort_by }}';
        var current_order = '{{ current_order }}';
    </script>
    <script src="{% static 'scripts/all_reservations.js' %}"></script>
    <script>
        fetchFilteredData(page, current_sort_by, current_order, 'no');
    </script>
{% endblock %}